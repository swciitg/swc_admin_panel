import {NextResponse} from "next/server";
import { dbConnect } from "@/lib/dbConnect";
import <%= modelName %> from '<%= modelImportPath %>';
// to identify the model and get relative path through modelImportPath

export async function GET(){
    try{
        await dbConnect();
        const data = await <%= modelName %>.find({}).lean();
            // lean() is used to convert the mongoose document to a plain JavaScript object
        return NextResponse.json({data},{status:200},{message:"Data fetched successfully"});
    }
    catch(error){
        return NextResponse.json(
            {error:error.message},
            {status:500}
        );
    }
}

export async function POST(request) {
    try {
        await dbConnect();
        const body = await request.json();
        const data = body.data;
        if (!data) {
            return NextResponse.json(
            {status:500}, 
            {message: "Data not available"}
        ); 
        }
        const savedData = await <%= modelName %>.insertOne(data);
        return NextResponse.json(
            {status:200}, 
            {message: "Data added successfully"}
        );

    }
    catch(error) {
        return NextResponse.json(
            {error:error.message},
            {status:500}
        );
    }
}